<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>‚ùÑÔ∏è Programmatic Holiday Movie Title Generator üéÑ</title>
  <link rel="preload" as="image" href="./assets/holiday-cozy-town.webp" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{ --bg:#0b0b0c; --card:#121214; --ink:#f5f5f7; --muted:#c9c9d1; --line:#27272a; --accent:#22d3ee; --accent2:#84cc16; }
    *{box-sizing:border-box}
    body{
      margin:0;
      /* Image hero + contrast overlay */
      background-color:#0b0b0c; /* fallback */
      background-image:
        linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.55)),
        url("./assets/holiday-cozy-town.webp");
      background-size: auto, cover;
      background-repeat: no-repeat, no-repeat;
      background-position: 0 0, center;
      background-attachment: scroll, fixed;
      color:var(--ink);
      font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      position:relative;
    }
    /* removed: previous vignette/noise overlay in favor of clean image hero */
    
    /* bokeh Christmas lights overlay */
    /* removed: twinkling bokeh overlay to keep hero image clear */ to { opacity: .95; } }
    @keyframes twinkle { from { opacity: .55; } to { opacity: .9; } }
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{
      width:100%;max-width:820px;
      background:rgba(18,18,20,.45); /* translucent */
      backdrop-filter:saturate(120%) blur(10px);
      -webkit-backdrop-filter:saturate(120%) blur(10px);
      border:1px solid rgba(255,255,255,.08);
      border-radius:22px;
      box-shadow:0 18px 60px rgba(0,0,0,.35)
    }
    .body{padding:28px}
    h1{margin:0 0 12px;font-weight:900;font-size:28px;letter-spacing:.2px}
    p{margin:0 0 18px;color:var(--muted)}
    .row{display:grid;grid-template-columns:1fr auto auto;gap:12px;align-items:end}
    @media(max-width:780px){ .row{grid-template-columns:1fr; } }
    .label{display:block;color:#9aa0a6;font-size:12px;margin:0 0 8px}
    .dob-fields{display:flex; gap:10px; flex-wrap:wrap}
    .dob-col{display:flex;flex-direction:column;gap:6px}
    .mini-label{font-size:11px;color:#a5a8b1;letter-spacing:.4px}
    .dob-input{width:110px; padding:12px 14px; border-radius:12px;border:1px solid var(--line); background:#0c0c0f; color:#fff; outline:none;box-shadow:0 0 0 0 rgba(34,211,238,0);transition:border .15s ease, box-shadow .15s ease, transform .02s ease;}
    .dob-input.mm,.dob-input.dd{width:88px}
    .dob-input:focus{border-color: color-mix(in srgb,var(--accent),#fff 60%);box-shadow:0 0 0 4px rgba(34,211,238,.18);}
    .btn{padding:12px 14px;border-radius:12px;border:1px solid var(--line);background:#0c0c0f;color:#fff;cursor:pointer;transition:0.2s; font-weight:600}
    .btn:hover{background:#1a1a1d}
    .btn:active{transform:translateY(1px)}
    .btn.primary{border-color:color-mix(in srgb,var(--accent),#fff 70%);background:linear-gradient(180deg, color-mix(in srgb,var(--accent), transparent 70%), rgba(0,0,0,.2));color:#e6fff9}
    .btn.secondary{border-color:#3a3a42; color:#f1f1f6; background:#0e0e12}
    .btn[disabled]{opacity:.5;cursor:not-allowed}
    .panel{
      margin-top:18px;
      border:1px solid rgba(255,255,255,.08);
      border-radius:14px;
      background:rgba(12,12,15,.50); /* translucent */
      backdrop-filter:saturate(120%) blur(6px);
      -webkit-backdrop-filter:saturate(120%) blur(6px);
      padding:18px
    }
    .panel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    .panel-header .kicker{color:#a7f3d0;font-size:12px;font-weight:700;letter-spacing:.4px}
    .copy-btn{opacity:0; pointer-events:none; transform:translateY(-4px); transition:opacity .25s ease, transform .25s ease;}
    .copy-btn.show{opacity:1; pointer-events:auto; transform:translateY(0);}
    .title{margin:0;min-height:38px;font-size:30px;font-weight:900;line-height:1.2;background:linear-gradient(90deg, #eafffb 0%, #e5ffcf 60%, #eafffb 100%);-webkit-background-clip:text; background-clip:text; color:transparent;text-shadow:0 0 18px rgba(209,255,209,.18)}
    .hint{font-size:12px;color:#9aa0a6;margin-top:14px}
    #posterPrompt{width:100%;box-sizing:border-box;padding:.75rem;border-radius:12px;border:1px solid var(--line);background:#0c0c0f;color:#eee;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace}
    .tiny{font-size:12px;color:#9aa0a6;margin-top:8px}
    /* Error styles */
    .error{margin-top:6px;color:#fca5a5;font-size:12px}
    .dob-input.invalid{border-color:#ef4444; box-shadow:0 0 0 4px rgba(239,68,68,.18)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="body">
        <h1>‚ùÑÔ∏è Programmatic Holiday Movie Title Generator üéÑ</h1>
        <p>Enter your <b>date of birth</b>. We‚Äôll use your <i>day</i>, <i>month</i>, and the <i>last digit of your year</i> to conjure a cozy, holiday-season title with a programmatic twist.</p>

        <div class="row">
          <label>
            <span class="label">Date of Birth</span>
            <div class="dob-fields">
              <div class="dob-col"><span class="mini-label">Year</span><input id="dobY" class="dob-input yy" inputmode="numeric" placeholder="YYYY" maxlength="4" /></div>
              <div class="dob-col"><span class="mini-label">Month</span><input id="dobM" class="dob-input mm" inputmode="numeric" placeholder="MM" maxlength="2" /></div>
              <div class="dob-col"><span class="mini-label">Day</span><input id="dobD" class="dob-input dd" inputmode="numeric" placeholder="DD" maxlength="2" /></div>
            </div>
            <div id="dobError" class="error" role="alert" aria-live="polite"></div>
          </label>
          <button id="generate" class="btn primary">Generate</button>
          <button id="randomize" class="btn secondary">Randomize</button>
        </div>

        <div class="panel">
          <div class="panel-header"><div class="kicker">Your Movie Title</div><button id="copy" class="btn primary copy-btn" disabled>Copy Title</button></div>
          <h2 id="title" class="title">Pick a date to summon your title‚Ä¶</h2>
          <div class="hint">Tip: Copy your title and paste it in the thread!</div>
        </div>

        <div class="panel" id="posterPromptSection" aria-live="polite">
          <div class="panel-header"><div class="kicker">Holiday Poster Prompt</div><button id="copyPosterPromptBtn" class="btn primary copy-btn" disabled>Copy Prompt</button></div>
          <textarea id="posterPrompt" readonly rows="8" placeholder="Your copy-and-paste chatbot prompt will appear here."></textarea>
          <div class="tiny">Paste this into your favorite image chatbot to get a custom holiday movie poster (2:3 portrait recommended).</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Config =====
    const YEAR_MIN = 1900, YEAR_MAX = 2099;

    // ===== Dictionaries =====
    const dayWords={
      1:"Snowfall",2:"Tinsel",3:"Midnight",4:"Holly",5:"Reindeer",6:"Mistletoe",7:"Carolers",8:"Wonderland",9:"Blizzard",10:"North Star",
      11:"Gingerbread",12:"Nutcracker",13:"Evergreen",14:"Sleigh",15:"Polar Night",16:"Frost",17:"Cocoa",18:"Lights",19:"Bells",20:"Gift Wrap",
      21:"Snowmen",22:"Peppermint",23:"Starlight",24:"Silent Snow",25:"Candlelight",26:"Toymaker",27:"Chimney",28:"Midwinter",29:"Yuletide",30:"Winter Spirits",31:"Sleighbells"
    };
    const monthTwist={
      1:"of the",2:"in the",3:"from the",4:"under the",5:"beyond the",6:"through the",7:"around the",8:"by the",9:"within the",10:"above the",11:"- miracle of the",12:"- return of the"
    };
    const yearThing={
      0:"Ad Exchange",1:"Attribution Model",2:"Bot Traffic",3:"Cookies",4:"Bid Optimizer",5:"Bounce Rate",6:"Bid Multiplier",7:"Deal Troubleshooter",8:"Audience Segment",9:"Report Builder"
    };

    // ===== Elements =====
    const elY=document.getElementById("dobY"),
          elM=document.getElementById("dobM"),
          elD=document.getElementById("dobD"),
          elTitle=document.getElementById("title"),
          elCopy=document.getElementById("copy"),
          elGenerate=document.getElementById("generate"),
          elRandomize=document.getElementById("randomize"),
          elPosterTA=document.getElementById('posterPrompt'),
          elPosterCopy=document.getElementById('copyPosterPromptBtn'),
          elErr=document.getElementById('dobError');

    const daysInMonth=(y,m)=>new Date(y,m,0).getDate();
    const randomElement = arr => arr[Math.floor(Math.random()*arr.length)];
    const revealCopy=(btn,show)=>{ btn.classList.toggle('show',!!show); btn.disabled=!show; };
    const clearErrors=()=>{ [elY,elM,elD].forEach(el=>el.classList.remove('invalid')); elErr.textContent=''; };

    // ===== Core helpers =====
    function buildISO(){
      const y=parseInt(elY.value,10), m=parseInt(elM.value,10), d=parseInt(elD.value,10);
      if(!y||!m||!d) return "";
      if(m<1||m>12) return "";
      const dim=daysInMonth(y,m);
      if(d<1||d>dim) return "";
      return `${y}-${String(m).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
    }

    function titleFromISO(iso){
      if(!iso) return "";
      const [y,m,d]=iso.split("-").map(Number);
      return `${dayWords[d]} ${monthTwist[m]} ${yearThing[y%10]}`;
    }

    // Keep numeric; allow leading zeros; no range clamp while typing
    function sanitize(){
      elY.value = elY.value.replace(/[^0-9]+/g, '').slice(0,4);
      elM.value = elM.value.replace(/[^0-9]+/g, '').slice(0,2);
      elD.value = elD.value.replace(/[^0-9]+/g, '').slice(0,2);
    }
    function padOnBlurMonth(){ if (elM.value.length === 1) elM.value = '0' + elM.value; }
    function padOnBlurDay(){ if (elD.value.length === 1) elD.value = '0' + elD.value; }

    // ===== Validation (simple) =====
    function validateFields(){
      const errs={};
      const yStr=elY.value, mStr=elM.value, dStr=elD.value;
      const y=+yStr, m=+mStr, d=+dStr;
      const yearValid=(yStr.length===4 && !Number.isNaN(y) && y>=YEAR_MIN && y<=YEAR_MAX);
      const monthValid=(!Number.isNaN(m) && m>=1 && m<=12);
      if(!yearValid) errs.year='Invalid year.';
      if(!monthValid) errs.month='Invalid month.';
      let dayValid=(!Number.isNaN(d) && d>=1 && d<=31);
      if(dayValid && yearValid && monthValid){ dayValid = d<=daysInMonth(y,m); }
      if(!dayValid) errs.day='Invalid date.';
      return { ok:Object.keys(errs).length===0, errs };
    }
    function showErrors(errs){
      elY.classList.toggle('invalid',!!errs.year);
      elM.classList.toggle('invalid',!!errs.month);
      elD.classList.toggle('invalid',!!errs.day);
      elErr.textContent=[errs.year,errs.month,errs.day].filter(Boolean).join(' ‚Ä¢ ');
    }

    // ===== Poster prompt =====
    function updatePosterPrompt(title){
      if(!title){ elPosterTA.value=''; revealCopy(elPosterCopy,false); return; }
      const moods=[
        "cozy, candlelit, snowfall outside",
        "sparkling festive lights, cheerful and bright",
        "quiet wintry magic, twinkling starlight",
        "retro holiday postcard vibes",
        "storybook whimsy with gentle glow"
      ];
      const settings=[
        "snowy town square with string lights",
        "living room by a decorated tree and fireplace",
        "festive street market with garlands and hot cocoa stands",
        "pine forest clearing with lanterns",
        "cozy window seat with frost and bokeh lights"
      ];
      const palettes=[
        "pine greens, cranberry reds, warm gold",
        "icy blues, snow whites, silver sparkle",
        "candlelight ambers, cocoa browns, evergreen",
        "midnight blues, aurora greens, soft white glow"
      ];
      const styles=[
        "vintage holiday poster illustration",
        "digital painting with cinematic rim light",
        "paper cut-out collage with texture",
        "retro 80s VHS holiday cover",
        "hand-painted storybook art"
      ];
      const mood=randomElement(moods), setting=randomElement(settings), palette=randomElement(palettes), style=randomElement(styles);
      const prompt=[
        `Create a holiday movie poster titled "${title}".`,
        `Mood: ${mood}.`,
        `Setting: ${setting}.`,
        `Palette: ${palette}.`,
        `Style: ${style}.`,
        `Typography: bold, festive lettering for the title; optional small tagline below.`,
        `Framing: vertical 2:3 portrait composition.`,
        `Include only the movie title text: "${title}".`
      ].join("\n");
      elPosterTA.value=prompt; revealCopy(elPosterCopy,true);
    }

    // ===== Generate & Randomize =====
    function generateTitle(){
      sanitize();
      const {ok,errs}=validateFields();
      if(!ok){ showErrors(errs); if(errs.year) elY.focus(); else if(errs.month) elM.focus(); else if(errs.day) elD.focus(); return; }
      clearErrors();
      const iso=buildISO();
      const t=titleFromISO(iso);
      elTitle.textContent=t||"Pick a date to summon your title‚Ä¶";
      revealCopy(elCopy, !!t);
      updatePosterPrompt(t);
    }

    function randomizeDate(){
      // Choose a valid date and immediately generate
      const year = 1970 + Math.floor(Math.random()*45);
      const month = Math.floor(Math.random()*12) + 1;
      const dim = daysInMonth(year, month);
      const day = Math.floor(Math.random()*dim) + 1;
      elY.value=String(year);
      elM.value=String(month).padStart(2,"0");
      elD.value=String(day).padStart(2,"0");
      clearErrors();
      generateTitle();
    }

    // ===== UI wiring =====
    function handleInput(e){
      sanitize();
      clearErrors(); // no errors while editing
      const t=e.target;
      if(t===elY && t.value.length>=4) elM.focus();
      if(t===elM && t.value.length>=2) elD.focus();
    }
    function backspaceNav(e){ if(e.key==="Backspace" && e.target.value===""){ if(e.target===elD) elM.focus(); else if(e.target===elM) elY.focus(); } }

    [elY,elM,elD].forEach(el=>{ el.addEventListener("input",handleInput); el.addEventListener("keydown",backspaceNav); });
    elM.addEventListener('blur', padOnBlurMonth);
    elD.addEventListener('blur', padOnBlurDay);

    elGenerate.addEventListener("click",generateTitle);
    elRandomize.addEventListener("click",randomizeDate);

    elCopy.addEventListener("click", async ()=>{
      const t=elTitle.textContent.trim(); if(!t||t==="Pick a date to summon your title‚Ä¶") return;
      try{ await navigator.clipboard.writeText(`üé¨ ${t}`); const old=elCopy.textContent; elCopy.textContent="Copied!"; setTimeout(()=>elCopy.textContent=old,1200); }
      catch{ alert("Copy failed. Please copy manually."); }
    });

    elPosterCopy.addEventListener('click', async ()=>{
      const v=elPosterTA.value.trim(); if(!v) return;
      try{ await navigator.clipboard.writeText(v); const old=elPosterCopy.textContent; elPosterCopy.textContent="Copied!"; setTimeout(()=>elPosterCopy.textContent=old,1200); }
      catch{ elPosterTA.select(); document.execCommand('copy'); const old=elPosterCopy.textContent; elPosterCopy.textContent="Copied (fallback)!"; setTimeout(()=>elPosterCopy.textContent=old,1200); }
    });

    // Clean start + focus Year
    (function init(){
      clearErrors();
      elTitle.textContent = 'Pick a date to summon your title‚Ä¶';
      elPosterTA.value = '';
      revealCopy(elCopy,false); revealCopy(elPosterCopy,false);
      try { elY.focus(); } catch {}
    })();

    // (Optional) Mini tests behind ?test=1
    (function runTestsIfEnabled(){
      const qs=new URLSearchParams(location.search); if(qs.get('test')!=='1') return;
      const results=[]; const assert=(n,c)=>results.push({n,pass:!!c});
      const save={y:elY.value,m:elM.value,d:elD.value,msg:elErr.textContent,title:elTitle.textContent,prompt:elPosterTA.value};
      elY.value='1999'; elM.value='02'; elD.value='31'; assert('no errors before generate', elErr.textContent===''); generateTitle(); assert('errors on generate', elErr.textContent.includes('Invalid'));
      elY.value='2000'; elM.value='02'; elD.value='29'; clearErrors(); generateTitle(); assert('valid generates', elErr.textContent==='');
      randomizeDate(); assert('randomize fills fields', !!elY.value && !!elM.value && !!elD.value);
      elY.value=save.y; elM.value=save.m; elD.value=save.d; elErr.textContent=save.msg; elTitle.textContent=save.title; elPosterTA.value=save.prompt; clearErrors();
      const passed=results.filter(r=>r.pass).length; console.log(`Holiday generator tests: ${passed}/${results.length}`, results);
    })();
  </script>
</body>
</html>
